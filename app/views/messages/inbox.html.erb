<div class="container">
<h4>Inbox </h4>
<% @messages.all.each do |message| %>
<div class="message">
  <div class = "respond">
    <div class = "<%= message.id %>">
     <%= link_to "Respond" %>
    </div>
  </div>
  <%= image_tag User.find(message.sender_id).image, size: "35x35" %> <%=link_to User.find(message.sender_id).name, user_match_path(message.receiver_id, message.match_id) %><br/>
  <b>Sent:</b> <%= message.updated_at.to_formatted_s(:long_ordinal)  %> <br/>
  <b>Subject:</b> <div id="title<%=message.id%>"> <%=message.title%> </div> <br/>
   <div id = "message-text<%= message.id %>"><%= simple_format h(message.body) %></div>
  
 </div>
 <div id ="form<%= message.id %>"></div>
<% end %>
<div class="message-hidden">
<%= render partial: 'layouts/messageresponse' %>
</div>

<%= paginate @messages %>

</div>

<script>
$(function() {
  $('.respond').click(function(event){
    event.preventDefault();
    $('.message-hidden').toggle();
    var message =  $(this).children().attr('class');
    $(".message-hidden").appendTo("#form"+message);
    $(".container").find("#message_title").val("Re: " + $(".container").find("#title"+message).text())
    $(".container").find("#message_body").val("\n___________________\n" + $(".container").find("#message-text"+message).text())
    $(".container").find("#message_id").val(message)
  });
});  
</script>